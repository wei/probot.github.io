<p>Groups CI checks based on the sub-projects for monorepo projects.</p><h2>Motivation</h2><p>For example, a monorepo project can define that changes checked into documentation (e.g. files in <code>docs/**.md</code>) should pass a set of checks (e.g. <code>markdown lint</code> and <code>github_pages_build</code>), and changes checked into mobile app source code (e.g. files in <code>clients/app/**.dart</code>) should pass another set of checks (e.g. <code>app_unit_tests</code> and <code>app_integration_test</code>) before being merged. It's also possible that there is a set of checks to make sure related sub-projects are compatible (e.g. <code>compatibility_check</code>).</p><p>For the situation above, there is no easy way to guard the main branch with protected branch schema. The project has to either only define a subset of full CI checks as requirement leaving the main branch less secure or define and run a full list of CI checks for every pull request slowing down merging process.</p><p>With <strong>Check Group</strong>, we can add one more CI check that is a combination of CI checks based on sub-projects of interests. The protected branch rule can depend only on the combined check.</p><p>To fit the example above into the usecase, we can use the following configuration to tell Check Group how to collect required checks:</p><pre class="language-yml"><code class="language-yml"><span class="token key atrule">subprojects</span><span class="token punctuation">:</span><br>  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> documentation<br>    <span class="token key atrule">paths</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"docs/**.md"</span><br>    <span class="token key atrule">checks</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"markdown_lint"</span><br>      <span class="token punctuation">-</span> <span class="token string">"github_pages_build"</span><br>  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> mobile_app<br>    <span class="token key atrule">paths</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"clients/app/**"</span><br>    <span class="token key atrule">checks</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"app_static_analysis"</span><br>      <span class="token punctuation">-</span> <span class="token string">"app_unit_tests"</span><br>      <span class="token punctuation">-</span> <span class="token string">"compatibility_check"</span><br>  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> cli_app<br>    <span class="token key atrule">paths</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"clients/cli/**"</span><br>    <span class="token key atrule">checks</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"cli_unit_tests"</span><br>      <span class="token punctuation">-</span> <span class="token string">"compatibility_check"</span></code></pre><p>With the configuration above, Check Group collects the requirements that will secure the main branch and only LGTM if they all pass.</p><p>Here is an example of how it works in the <a href="https://github.com/tianhaoz95/check-group-demo/pull/1">pull request</a>:</p><p><img src="https://github.com/tianhaoz95/check-group/raw/master/docs/assets/screenshot/example_pr_checks.png" alt="screenshot of the pr checks"></p><p>A list of requirements and current fulfillment status is available in the &quot;Details&quot;:</p><p><img src="https://github.com/tianhaoz95/check-group/raw/master/docs/assets/screenshot/check_details.png" alt="screenshot of the details view"></p><p>Note: since Check Group converts all required checks into a single check to make protected branch happy, the repository only needs to run the affected checks for pull requests. There are many ways to do on every CI/CD platform. Here's an example with GitHub Actions for the usecase above (for more details, check out the <a href="https://github.com/tianhaoz95/check-group-demo">example project</a>):</p><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> app checks<br><span class="token key atrule">on</span><span class="token punctuation">:</span><br>  <span class="token key atrule">pull_request</span><span class="token punctuation">:</span><br>    <span class="token key atrule">branches</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"master"</span><br>    <span class="token key atrule">paths</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"clients/app/**"</span><br><span class="token key atrule">jobs</span><span class="token punctuation">:</span><br>  <span class="token key atrule">app_static_analysis</span><span class="token punctuation">:</span> <span class="token punctuation">...</span><br>  <span class="token key atrule">app_unit_tests</span><span class="token punctuation">:</span> <span class="token punctuation">...</span></code></pre>