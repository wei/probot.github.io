<blockquote><p>A GitHub App built with <a href="https://github.com/probot/probot">Probot</a> that allows Pull Request authors to self-approve their Pull Requests.</p></blockquote><p><img src="https://raw.githubusercontent.com/CubikTech/self-approval/main/screenshot.png" alt="Screenshot"></p><blockquote><p>Special thanks to <a href="https://github.com/dkhmelenko/autoapproval">dkhmelenko/autoapproval</a> for providing some inspiration and also some code implementation for this App.</p></blockquote><h2>Introduction</h2><p>For some repositories, the Pull Request have to be approved before it can be merged. And this GitHub App allows some whitelisted maintainers to self-approve their Pull Requests, so they can directly approve and merge their own Pull Requests.</p><h2>Setup</h2><pre class="language-shell"><code class="language-shell"><span class="token comment"># Install dependencies</span>
<span class="token function">npm</span> <span class="token function">install</span>

<span class="token comment"># Build the app</span>
<span class="token function">npm</span> run build

<span class="token comment"># Run the bot</span>
<span class="token function">npm</span> start

<span class="token comment"># Run tests, `npm run build` should be run first</span>
<span class="token function">npm</span> run <span class="token builtin class-name">test</span></code></pre><h2>Deploy</h2><h3>Register the GitHub App</h3><p>See <a href="https://probot.github.io/docs/deployment/#register-the-github-app">Deployment - Probot</a></p><h3>Deploy the app on a server</h3><ol><li>Clone the repository</li><li>Copy a file <code>.env</code> from the <code>.env.example</code> file and fill in the required values:<ul><li><code>APP_ID</code>: the ID of the app, which you can get from the <a href="https://github.com/settings/apps">app settings page</a>.</li><li><code>GITHUB_CLIENT_ID</code>: the Client ID of the app, which you can get from the <a href="https://github.com/settings/apps">app settings page</a>.</li><li><code>GITHUB_CLIENT_SECRET</code>: the Client Secret of the app, which you can generate and get from the <a href="https://github.com/settings/apps">app settings page</a>.</li><li><code>WEBHOOK_SECRET</code>: the <strong>Webhook Secret</strong> that you generated when you created the app.</li><li><code>PRIVATE_KEY</code>: the contents of the private key you downloaded after creating the app.</li></ul></li><li>Run <code>npm install</code> to install the dependencies</li><li>Run <code>npm build</code> to build the app.</li><li>Run <code>npm start</code> to start the app.</li><li>Setup HTTPS and domain name for the app. You can use multiple ways to do this (e.g. Nginx &amp; Certbot).</li></ol><h3>Set the <strong>Webhook URL</strong></h3><p>Set the <strong>Webhook URL</strong> of your GitHub App to your domain or <code>ip:port</code>.</p><h3>Update the app</h3><ol><li>Pull the latest code from the repository.</li><li>Redo the steps 3 to 5 for deploying the app.</li></ol><h3>Change the port</h3><p>Go to the <code>.env</code> file and change the value of <code>PORT</code> to the port you want to use.</p><h2>Configuration</h2><p>In order to use the bot, the config file should be provided. Config file should be defined in your repository. Config file is the yml file with the path <code>.github/self-approval-pull-request.yml</code>. And the file should have these 3 entries: <code>self_approval_comments</code>, <code>from_author</code> and <code>apply_labels</code>.</p><hr><h3>self_approval_comments</h3><p>Define the list of comments that will be considered as self-approval.</p><pre class="language-yml"><code class="language-yml"><span class="token key atrule">self_approval_comments</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">"I self-approve!"</span>
  <span class="token punctuation">-</span> <span class="token string">"I self-certify!"</span></code></pre><hr><h3>from_author</h3><p>Define the list of GitHub users who can self-approve their Pull Request.</p><pre class="language-yml"><code class="language-yml"><span class="token key atrule">from_author</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">"Cubik65536"</span>
  <span class="token punctuation">-</span> <span class="token string">"&lt;GitHub ID of other project maintainer>"</span></code></pre><p>Assign an empty array if you want everyone can self-approve their Pull Requests (example: <code>from_author: []</code>).</p><hr><h3>apply_labels</h3><p>Defines the list of labels on PR, which should be added once PR was approved. For example:</p><pre class="language-yml"><code class="language-yml"><span class="token key atrule">apply_labels</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">"can-be-merged"</span>
  <span class="token punctuation">-</span> <span class="token string">"self-approved"</span></code></pre><p>Assign an empty array if no labels should be applied to PRs (example: <code>apply_labels: []</code>).</p><hr><h2>Contributing</h2><p>If you have suggestions for how self-approval could be improved, or want to report a bug, open an issue! We'd love all and any contributions.</p><p>For more, check out the <a href="CONTRIBUTING.md">Contributing Guide</a>.</p><h2>License</h2><p><a href="LICENSE">ISC</a> Â© 2022 Cubik Technology &amp; Cubik65536</p>